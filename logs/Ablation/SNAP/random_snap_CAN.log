
=== Configuration ===
device: cuda:2
seed: 3407
batch_size: 32
epochs: 100
num_workers: 8
learning_rate: 0.0003
weight_decay: 5e-05
patience: 10
task: SNAP
task_lower: snap
data_prefix: random
fusion: CAN
======================


============================================================
Training Seed 42
============================================================
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_42/random_train.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 19403 valid pairs (time: 236.36s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_42/random_val.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 2772 valid pairs (time: 33.58s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_42/random_test.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 5536 valid pairs (time: 64.73s)
[Epoch 1/100] Train Loss: 0.6041 Valid Loss: 0.5773 | Acc: 0.7381 | Prec: 0.7835 | Recall: 0.6648 | F1: 0.7193 | MCC: 0.4826 | AUROC: 0.8152 | AUPR: 0.8300
[Epoch 2/100] Train Loss: 0.5560 Valid Loss: 0.5579 | Acc: 0.7514 | Prec: 0.8034 | Recall: 0.6719 | F1: 0.7318 | MCC: 0.5106 | AUROC: 0.8385 | AUPR: 0.8458
[Epoch 3/100] Train Loss: 0.5253 Valid Loss: 0.5100 | Acc: 0.7814 | Prec: 0.7850 | Recall: 0.7806 | F1: 0.7828 | MCC: 0.5628 | AUROC: 0.8665 | AUPR: 0.8800
[Epoch 4/100] Train Loss: 0.5219 Valid Loss: 0.5140 | Acc: 0.7857 | Prec: 0.7923 | Recall: 0.7798 | F1: 0.7860 | MCC: 0.5715 | AUROC: 0.8668 | AUPR: 0.8736
[Epoch 5/100] Train Loss: 0.4996 Valid Loss: 0.5043 | Acc: 0.7908 | Prec: 0.8558 | Recall: 0.7041 | F1: 0.7725 | MCC: 0.5917 | AUROC: 0.8746 | AUPR: 0.8860
[Epoch 6/100] Train Loss: 0.4856 Valid Loss: 0.6045 | Acc: 0.7442 | Prec: 0.6873 | Recall: 0.9049 | F1: 0.7812 | MCC: 0.5140 | AUROC: 0.8720 | AUPR: 0.8702
EarlyStopping counter: 1 out of 10
[Epoch 7/100] Train Loss: 0.4733 Valid Loss: 0.4984 | Acc: 0.7980 | Prec: 0.7722 | Recall: 0.8506 | F1: 0.8095 | MCC: 0.5987 | AUROC: 0.8835 | AUPR: 0.8917
[Epoch 8/100] Train Loss: 0.4623 Valid Loss: 0.4849 | Acc: 0.8084 | Prec: 0.7989 | Recall: 0.8292 | F1: 0.8137 | MCC: 0.6172 | AUROC: 0.8893 | AUPR: 0.8964
[Epoch 9/100] Train Loss: 0.4497 Valid Loss: 0.4750 | Acc: 0.8189 | Prec: 0.8070 | Recall: 0.8427 | F1: 0.8245 | MCC: 0.6383 | AUROC: 0.8984 | AUPR: 0.9007
[Epoch 10/100] Train Loss: 0.4426 Valid Loss: 0.4810 | Acc: 0.8135 | Prec: 0.8257 | Recall: 0.7991 | F1: 0.8122 | MCC: 0.6274 | AUROC: 0.8902 | AUPR: 0.8929
EarlyStopping counter: 1 out of 10
[Epoch 11/100] Train Loss: 0.4412 Valid Loss: 0.4633 | Acc: 0.8261 | Prec: 0.8315 | Recall: 0.8220 | F1: 0.8267 | MCC: 0.6523 | AUROC: 0.9024 | AUPR: 0.9020
[Epoch 12/100] Train Loss: 0.4320 Valid Loss: 0.4765 | Acc: 0.8182 | Prec: 0.8203 | Recall: 0.8192 | F1: 0.8197 | MCC: 0.6363 | AUROC: 0.8954 | AUPR: 0.8998
EarlyStopping counter: 1 out of 10
[Epoch 13/100] Train Loss: 0.4189 Valid Loss: 0.4676 | Acc: 0.8232 | Prec: 0.8012 | Recall: 0.8642 | F1: 0.8315 | MCC: 0.6482 | AUROC: 0.9028 | AUPR: 0.8968
[Epoch 14/100] Train Loss: 0.4172 Valid Loss: 0.5231 | Acc: 0.7886 | Prec: 0.7412 | Recall: 0.8928 | F1: 0.8100 | MCC: 0.5891 | AUROC: 0.8810 | AUPR: 0.8787
EarlyStopping counter: 1 out of 10
[Epoch 15/100] Train Loss: 0.4203 Valid Loss: 0.4633 | Acc: 0.8283 | Prec: 0.8266 | Recall: 0.8349 | F1: 0.8307 | MCC: 0.6565 | AUROC: 0.9038 | AUPR: 0.8993
[Epoch 16/100] Train Loss: 0.4081 Valid Loss: 0.4585 | Acc: 0.8272 | Prec: 0.8267 | Recall: 0.8320 | F1: 0.8294 | MCC: 0.6544 | AUROC: 0.9070 | AUPR: 0.9083
[Epoch 17/100] Train Loss: 0.4003 Valid Loss: 0.4600 | Acc: 0.8373 | Prec: 0.8098 | Recall: 0.8856 | F1: 0.8460 | MCC: 0.6773 | AUROC: 0.9077 | AUPR: 0.8995
[Epoch 18/100] Train Loss: 0.3883 Valid Loss: 0.4589 | Acc: 0.8380 | Prec: 0.8374 | Recall: 0.8427 | F1: 0.8400 | MCC: 0.6760 | AUROC: 0.9076 | AUPR: 0.9100
EarlyStopping counter: 1 out of 10
[Epoch 19/100] Train Loss: 0.3922 Valid Loss: 0.4588 | Acc: 0.8409 | Prec: 0.8412 | Recall: 0.8442 | F1: 0.8427 | MCC: 0.6818 | AUROC: 0.9083 | AUPR: 0.9082
[Epoch 20/100] Train Loss: 0.3793 Valid Loss: 0.4600 | Acc: 0.8402 | Prec: 0.8711 | Recall: 0.8020 | F1: 0.8351 | MCC: 0.6828 | AUROC: 0.9103 | AUPR: 0.9091
[Epoch 21/100] Train Loss: 0.3753 Valid Loss: 0.4603 | Acc: 0.8337 | Prec: 0.8152 | Recall: 0.8670 | F1: 0.8403 | MCC: 0.6685 | AUROC: 0.9099 | AUPR: 0.9124
EarlyStopping counter: 1 out of 10
[Epoch 22/100] Train Loss: 0.3758 Valid Loss: 0.4583 | Acc: 0.8398 | Prec: 0.8394 | Recall: 0.8442 | F1: 0.8418 | MCC: 0.6796 | AUROC: 0.9078 | AUPR: 0.9049
EarlyStopping counter: 2 out of 10
[Epoch 23/100] Train Loss: 0.3640 Valid Loss: 0.4510 | Acc: 0.8402 | Prec: 0.8541 | Recall: 0.8242 | F1: 0.8389 | MCC: 0.6809 | AUROC: 0.9131 | AUPR: 0.9020
[Epoch 24/100] Train Loss: 0.3599 Valid Loss: 0.4688 | Acc: 0.8344 | Prec: 0.8088 | Recall: 0.8799 | F1: 0.8429 | MCC: 0.6712 | AUROC: 0.9101 | AUPR: 0.9098
EarlyStopping counter: 1 out of 10
[Epoch 25/100] Train Loss: 0.3542 Valid Loss: 0.4685 | Acc: 0.8366 | Prec: 0.8262 | Recall: 0.8563 | F1: 0.8410 | MCC: 0.6735 | AUROC: 0.9051 | AUPR: 0.9016
EarlyStopping counter: 2 out of 10
[Epoch 26/100] Train Loss: 0.3521 Valid Loss: 0.4732 | Acc: 0.8395 | Prec: 0.8232 | Recall: 0.8685 | F1: 0.8452 | MCC: 0.6798 | AUROC: 0.9035 | AUPR: 0.8933
EarlyStopping counter: 3 out of 10
[Epoch 27/100] Train Loss: 0.3456 Valid Loss: 0.4765 | Acc: 0.8427 | Prec: 0.8328 | Recall: 0.8613 | F1: 0.8468 | MCC: 0.6857 | AUROC: 0.9036 | AUPR: 0.9003
EarlyStopping counter: 4 out of 10
[Epoch 28/100] Train Loss: 0.3423 Valid Loss: 0.4605 | Acc: 0.8442 | Prec: 0.8369 | Recall: 0.8585 | F1: 0.8476 | MCC: 0.6884 | AUROC: 0.9118 | AUPR: 0.9113
EarlyStopping counter: 5 out of 10
[Epoch 29/100] Train Loss: 0.3348 Valid Loss: 0.4674 | Acc: 0.8420 | Prec: 0.8293 | Recall: 0.8649 | F1: 0.8467 | MCC: 0.6845 | AUROC: 0.9072 | AUPR: 0.9054
EarlyStopping counter: 6 out of 10
[Epoch 30/100] Train Loss: 0.2997 Valid Loss: 0.4586 | Acc: 0.8532 | Prec: 0.8397 | Recall: 0.8763 | F1: 0.8576 | MCC: 0.7069 | AUROC: 0.9192 | AUPR: 0.9154
[Epoch 31/100] Train Loss: 0.2841 Valid Loss: 0.4667 | Acc: 0.8575 | Prec: 0.8545 | Recall: 0.8649 | F1: 0.8597 | MCC: 0.7150 | AUROC: 0.9167 | AUPR: 0.9104
EarlyStopping counter: 1 out of 10
[Epoch 32/100] Train Loss: 0.2740 Valid Loss: 0.4663 | Acc: 0.8582 | Prec: 0.8578 | Recall: 0.8620 | F1: 0.8599 | MCC: 0.7164 | AUROC: 0.9141 | AUPR: 0.9071
EarlyStopping counter: 2 out of 10
[Epoch 33/100] Train Loss: 0.2739 Valid Loss: 0.4719 | Acc: 0.8535 | Prec: 0.8422 | Recall: 0.8735 | F1: 0.8575 | MCC: 0.7074 | AUROC: 0.9123 | AUPR: 0.9012
EarlyStopping counter: 3 out of 10
[Epoch 34/100] Train Loss: 0.2691 Valid Loss: 0.4826 | Acc: 0.8535 | Prec: 0.8489 | Recall: 0.8635 | F1: 0.8561 | MCC: 0.7071 | AUROC: 0.9094 | AUPR: 0.8933
EarlyStopping counter: 4 out of 10
[Epoch 35/100] Train Loss: 0.2620 Valid Loss: 0.4951 | Acc: 0.8525 | Prec: 0.8501 | Recall: 0.8592 | F1: 0.8546 | MCC: 0.7049 | AUROC: 0.9076 | AUPR: 0.8989
EarlyStopping counter: 5 out of 10
[Epoch 36/100] Train Loss: 0.2581 Valid Loss: 0.4846 | Acc: 0.8528 | Prec: 0.8350 | Recall: 0.8828 | F1: 0.8582 | MCC: 0.7066 | AUROC: 0.9087 | AUPR: 0.8979
EarlyStopping counter: 6 out of 10
[Epoch 37/100] Train Loss: 0.2556 Valid Loss: 0.4804 | Acc: 0.8528 | Prec: 0.8424 | Recall: 0.8713 | F1: 0.8566 | MCC: 0.7059 | AUROC: 0.9085 | AUPR: 0.8904
EarlyStopping counter: 7 out of 10
[Epoch 38/100] Train Loss: 0.2545 Valid Loss: 0.4797 | Acc: 0.8503 | Prec: 0.8374 | Recall: 0.8728 | F1: 0.8547 | MCC: 0.7011 | AUROC: 0.9103 | AUPR: 0.8982
EarlyStopping counter: 8 out of 10
[Epoch 39/100] Train Loss: 0.2567 Valid Loss: 0.4871 | Acc: 0.8525 | Prec: 0.8419 | Recall: 0.8713 | F1: 0.8563 | MCC: 0.7052 | AUROC: 0.9072 | AUPR: 0.8948
EarlyStopping counter: 9 out of 10
[Epoch 40/100] Train Loss: 0.2530 Valid Loss: 0.4873 | Acc: 0.8521 | Prec: 0.8495 | Recall: 0.8592 | F1: 0.8543 | MCC: 0.7042 | AUROC: 0.9095 | AUPR: 0.8922
EarlyStopping counter: 10 out of 10
Early stopping at epoch 40
Best model at epoch 30 with Score = 0.9192
Seed 42 Test Results:
[Test] Loss: 0.4657 | Acc: 0.8495 | Prec: 0.8354 | Recall: 0.8696 | F1: 0.8521 | MCC: 0.6997 | AUROC: 0.9160 | AUPR: 0.9126

============================================================
Training Seed 1234
============================================================
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_1234/random_train.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 19399 valid pairs (time: 215.05s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_1234/random_val.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 2766 valid pairs (time: 31.64s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_1234/random_test.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 5546 valid pairs (time: 61.52s)
[Epoch 1/100] Train Loss: 0.6025 Valid Loss: 0.5692 | Acc: 0.7383 | Prec: 0.8064 | Recall: 0.6330 | F1: 0.7092 | MCC: 0.4890 | AUROC: 0.8193 | AUPR: 0.8298
[Epoch 2/100] Train Loss: 0.5414 Valid Loss: 0.5417 | Acc: 0.7683 | Prec: 0.8233 | Recall: 0.6882 | F1: 0.7497 | MCC: 0.5446 | AUROC: 0.8530 | AUPR: 0.8572
[Epoch 3/100] Train Loss: 0.5192 Valid Loss: 0.5461 | Acc: 0.7668 | Prec: 0.7898 | Recall: 0.7326 | F1: 0.7601 | MCC: 0.5353 | AUROC: 0.8477 | AUPR: 0.8491
EarlyStopping counter: 1 out of 10
[Epoch 4/100] Train Loss: 0.5050 Valid Loss: 0.5284 | Acc: 0.8030 | Prec: 0.8158 | Recall: 0.7871 | F1: 0.8012 | MCC: 0.6064 | AUROC: 0.8767 | AUPR: 0.8737
[Epoch 5/100] Train Loss: 0.4929 Valid Loss: 0.4920 | Acc: 0.8008 | Prec: 0.8349 | Recall: 0.7541 | F1: 0.7925 | MCC: 0.6048 | AUROC: 0.8820 | AUPR: 0.8926
[Epoch 6/100] Train Loss: 0.4827 Valid Loss: 0.5069 | Acc: 0.7968 | Prec: 0.8406 | Recall: 0.7369 | F1: 0.7853 | MCC: 0.5987 | AUROC: 0.8820 | AUPR: 0.8807
EarlyStopping counter: 1 out of 10
[Epoch 7/100] Train Loss: 0.4855 Valid Loss: 0.4972 | Acc: 0.8116 | Prec: 0.8754 | Recall: 0.7305 | F1: 0.7964 | MCC: 0.6327 | AUROC: 0.8828 | AUPR: 0.8943
[Epoch 8/100] Train Loss: 0.4683 Valid Loss: 0.4856 | Acc: 0.8156 | Prec: 0.8177 | Recall: 0.8165 | F1: 0.8171 | MCC: 0.6312 | AUROC: 0.8902 | AUPR: 0.8974
[Epoch 9/100] Train Loss: 0.4620 Valid Loss: 0.4808 | Acc: 0.8225 | Prec: 0.8450 | Recall: 0.7935 | F1: 0.8185 | MCC: 0.6464 | AUROC: 0.9011 | AUPR: 0.9050
[Epoch 10/100] Train Loss: 0.4522 Valid Loss: 0.4709 | Acc: 0.8239 | Prec: 0.8383 | Recall: 0.8065 | F1: 0.8221 | MCC: 0.6484 | AUROC: 0.8999 | AUPR: 0.9055
EarlyStopping counter: 1 out of 10
[Epoch 11/100] Train Loss: 0.4449 Valid Loss: 0.4760 | Acc: 0.8210 | Prec: 0.8099 | Recall: 0.8430 | F1: 0.8261 | MCC: 0.6425 | AUROC: 0.8968 | AUPR: 0.9001
EarlyStopping counter: 2 out of 10
[Epoch 12/100] Train Loss: 0.4426 Valid Loss: 0.4613 | Acc: 0.8275 | Prec: 0.8360 | Recall: 0.8186 | F1: 0.8272 | MCC: 0.6553 | AUROC: 0.9043 | AUPR: 0.9143
[Epoch 13/100] Train Loss: 0.4405 Valid Loss: 0.4838 | Acc: 0.8153 | Prec: 0.8405 | Recall: 0.7821 | F1: 0.8102 | MCC: 0.6323 | AUROC: 0.8898 | AUPR: 0.8938
EarlyStopping counter: 1 out of 10
[Epoch 14/100] Train Loss: 0.4288 Valid Loss: 0.4730 | Acc: 0.8232 | Prec: 0.8442 | Recall: 0.7964 | F1: 0.8196 | MCC: 0.6476 | AUROC: 0.8975 | AUPR: 0.9047
EarlyStopping counter: 2 out of 10
[Epoch 15/100] Train Loss: 0.4199 Valid Loss: 0.4637 | Acc: 0.8380 | Prec: 0.8536 | Recall: 0.8194 | F1: 0.8361 | MCC: 0.6767 | AUROC: 0.9076 | AUPR: 0.9084
[Epoch 16/100] Train Loss: 0.4174 Valid Loss: 0.4641 | Acc: 0.8312 | Prec: 0.8447 | Recall: 0.8151 | F1: 0.8296 | MCC: 0.6628 | AUROC: 0.9050 | AUPR: 0.9100
EarlyStopping counter: 1 out of 10
[Epoch 17/100] Train Loss: 0.4151 Valid Loss: 0.4650 | Acc: 0.8341 | Prec: 0.8333 | Recall: 0.8387 | F1: 0.8360 | MCC: 0.6681 | AUROC: 0.9057 | AUPR: 0.9062
EarlyStopping counter: 2 out of 10
[Epoch 18/100] Train Loss: 0.4133 Valid Loss: 0.4646 | Acc: 0.8406 | Prec: 0.8565 | Recall: 0.8215 | F1: 0.8386 | MCC: 0.6818 | AUROC: 0.9064 | AUPR: 0.9052
EarlyStopping counter: 3 out of 10
[Epoch 19/100] Train Loss: 0.3807 Valid Loss: 0.4526 | Acc: 0.8442 | Prec: 0.8518 | Recall: 0.8366 | F1: 0.8441 | MCC: 0.6885 | AUROC: 0.9157 | AUPR: 0.9155
[Epoch 20/100] Train Loss: 0.3645 Valid Loss: 0.4609 | Acc: 0.8510 | Prec: 0.8488 | Recall: 0.8573 | F1: 0.8531 | MCC: 0.7021 | AUROC: 0.9166 | AUPR: 0.9126
[Epoch 21/100] Train Loss: 0.3561 Valid Loss: 0.4661 | Acc: 0.8482 | Prec: 0.8515 | Recall: 0.8466 | F1: 0.8490 | MCC: 0.6963 | AUROC: 0.9166 | AUPR: 0.9072
EarlyStopping counter: 1 out of 10
[Epoch 22/100] Train Loss: 0.3476 Valid Loss: 0.4518 | Acc: 0.8521 | Prec: 0.8614 | Recall: 0.8423 | F1: 0.8518 | MCC: 0.7045 | AUROC: 0.9174 | AUPR: 0.9162
[Epoch 23/100] Train Loss: 0.3417 Valid Loss: 0.4524 | Acc: 0.8474 | Prec: 0.8433 | Recall: 0.8566 | F1: 0.8499 | MCC: 0.6949 | AUROC: 0.9161 | AUPR: 0.9140
EarlyStopping counter: 1 out of 10
[Epoch 24/100] Train Loss: 0.3385 Valid Loss: 0.4518 | Acc: 0.8510 | Prec: 0.8469 | Recall: 0.8602 | F1: 0.8535 | MCC: 0.7021 | AUROC: 0.9169 | AUPR: 0.9122
EarlyStopping counter: 2 out of 10
[Epoch 25/100] Train Loss: 0.3315 Valid Loss: 0.4634 | Acc: 0.8489 | Prec: 0.8487 | Recall: 0.8523 | F1: 0.8505 | MCC: 0.6977 | AUROC: 0.9151 | AUPR: 0.9112
EarlyStopping counter: 3 out of 10
[Epoch 26/100] Train Loss: 0.3269 Valid Loss: 0.4624 | Acc: 0.8453 | Prec: 0.8527 | Recall: 0.8380 | F1: 0.8453 | MCC: 0.6907 | AUROC: 0.9170 | AUPR: 0.9147
EarlyStopping counter: 4 out of 10
[Epoch 27/100] Train Loss: 0.3233 Valid Loss: 0.4625 | Acc: 0.8453 | Prec: 0.8491 | Recall: 0.8430 | F1: 0.8460 | MCC: 0.6905 | AUROC: 0.9166 | AUPR: 0.9114
EarlyStopping counter: 5 out of 10
[Epoch 28/100] Train Loss: 0.3182 Valid Loss: 0.4612 | Acc: 0.8438 | Prec: 0.8351 | Recall: 0.8602 | F1: 0.8475 | MCC: 0.6878 | AUROC: 0.9181 | AUPR: 0.9142
[Epoch 29/100] Train Loss: 0.3077 Valid Loss: 0.4671 | Acc: 0.8438 | Prec: 0.8332 | Recall: 0.8631 | F1: 0.8479 | MCC: 0.6880 | AUROC: 0.9161 | AUPR: 0.9160
EarlyStopping counter: 1 out of 10
[Epoch 30/100] Train Loss: 0.3069 Valid Loss: 0.4627 | Acc: 0.8449 | Prec: 0.8411 | Recall: 0.8538 | F1: 0.8474 | MCC: 0.6898 | AUROC: 0.9155 | AUPR: 0.9116
EarlyStopping counter: 2 out of 10
[Epoch 31/100] Train Loss: 0.3050 Valid Loss: 0.4636 | Acc: 0.8449 | Prec: 0.8350 | Recall: 0.8631 | F1: 0.8488 | MCC: 0.6901 | AUROC: 0.9161 | AUPR: 0.9162
EarlyStopping counter: 3 out of 10
[Epoch 32/100] Train Loss: 0.3055 Valid Loss: 0.4693 | Acc: 0.8438 | Prec: 0.8477 | Recall: 0.8416 | F1: 0.8446 | MCC: 0.6876 | AUROC: 0.9144 | AUPR: 0.9137
EarlyStopping counter: 4 out of 10
[Epoch 33/100] Train Loss: 0.3061 Valid Loss: 0.4674 | Acc: 0.8463 | Prec: 0.8535 | Recall: 0.8394 | F1: 0.8464 | MCC: 0.6928 | AUROC: 0.9140 | AUPR: 0.9129
EarlyStopping counter: 5 out of 10
[Epoch 34/100] Train Loss: 0.3044 Valid Loss: 0.4656 | Acc: 0.8485 | Prec: 0.8594 | Recall: 0.8366 | F1: 0.8478 | MCC: 0.6973 | AUROC: 0.9175 | AUPR: 0.9137
EarlyStopping counter: 6 out of 10
[Epoch 35/100] Train Loss: 0.3063 Valid Loss: 0.4688 | Acc: 0.8463 | Prec: 0.8469 | Recall: 0.8487 | F1: 0.8478 | MCC: 0.6927 | AUROC: 0.9149 | AUPR: 0.9089
EarlyStopping counter: 7 out of 10
[Epoch 36/100] Train Loss: 0.3027 Valid Loss: 0.4688 | Acc: 0.8460 | Prec: 0.8419 | Recall: 0.8552 | F1: 0.8485 | MCC: 0.6920 | AUROC: 0.9159 | AUPR: 0.9143
EarlyStopping counter: 8 out of 10
[Epoch 37/100] Train Loss: 0.3040 Valid Loss: 0.4712 | Acc: 0.8485 | Prec: 0.8531 | Recall: 0.8452 | F1: 0.8491 | MCC: 0.6971 | AUROC: 0.9165 | AUPR: 0.9126
EarlyStopping counter: 9 out of 10
[Epoch 38/100] Train Loss: 0.3020 Valid Loss: 0.4666 | Acc: 0.8442 | Prec: 0.8380 | Recall: 0.8566 | F1: 0.8472 | MCC: 0.6884 | AUROC: 0.9168 | AUPR: 0.9150
EarlyStopping counter: 10 out of 10
Early stopping at epoch 38
Best model at epoch 28 with Score = 0.9181
Seed 1234 Test Results:
[Test] Loss: 0.4712 | Acc: 0.8410 | Prec: 0.8283 | Recall: 0.8611 | F1: 0.8443 | MCC: 0.6824 | AUROC: 0.9112 | AUPR: 0.9105

============================================================
Training Seed 3407
============================================================
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_3407/random_train.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 19400 valid pairs (time: 215.20s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_3407/random_val.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 2770 valid pairs (time: 31.38s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_3407/random_test.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 5541 valid pairs (time: 60.86s)
[Epoch 1/100] Train Loss: 0.6093 Valid Loss: 0.5913 | Acc: 0.7339 | Prec: 0.7782 | Recall: 0.6457 | F1: 0.7058 | MCC: 0.4735 | AUROC: 0.8087 | AUPR: 0.8263
[Epoch 2/100] Train Loss: 0.5434 Valid Loss: 0.5391 | Acc: 0.7718 | Prec: 0.8023 | Recall: 0.7144 | F1: 0.7558 | MCC: 0.5463 | AUROC: 0.8481 | AUPR: 0.8417
[Epoch 3/100] Train Loss: 0.5182 Valid Loss: 0.5261 | Acc: 0.7841 | Prec: 0.8173 | Recall: 0.7253 | F1: 0.7686 | MCC: 0.5712 | AUROC: 0.8661 | AUPR: 0.8563
[Epoch 4/100] Train Loss: 0.4981 Valid Loss: 0.5208 | Acc: 0.7899 | Prec: 0.8121 | Recall: 0.7480 | F1: 0.7787 | MCC: 0.5811 | AUROC: 0.8662 | AUPR: 0.8646
[Epoch 5/100] Train Loss: 0.4861 Valid Loss: 0.5039 | Acc: 0.8061 | Prec: 0.8036 | Recall: 0.8042 | F1: 0.8039 | MCC: 0.6122 | AUROC: 0.8814 | AUPR: 0.8774
[Epoch 6/100] Train Loss: 0.4726 Valid Loss: 0.5059 | Acc: 0.7921 | Prec: 0.7775 | Recall: 0.8115 | F1: 0.7941 | MCC: 0.5848 | AUROC: 0.8772 | AUPR: 0.8766
EarlyStopping counter: 1 out of 10
[Epoch 7/100] Train Loss: 0.4716 Valid Loss: 0.4856 | Acc: 0.8119 | Prec: 0.8227 | Recall: 0.7896 | F1: 0.8058 | MCC: 0.6241 | AUROC: 0.8879 | AUPR: 0.8934
[Epoch 8/100] Train Loss: 0.4611 Valid Loss: 0.5012 | Acc: 0.7978 | Prec: 0.7847 | Recall: 0.8145 | F1: 0.7993 | MCC: 0.5962 | AUROC: 0.8816 | AUPR: 0.8831
EarlyStopping counter: 1 out of 10
[Epoch 9/100] Train Loss: 0.4569 Valid Loss: 0.4807 | Acc: 0.8116 | Prec: 0.8071 | Recall: 0.8130 | F1: 0.8100 | MCC: 0.6231 | AUROC: 0.8914 | AUPR: 0.8951
[Epoch 10/100] Train Loss: 0.4538 Valid Loss: 0.4839 | Acc: 0.8116 | Prec: 0.8216 | Recall: 0.7904 | F1: 0.8057 | MCC: 0.6233 | AUROC: 0.8913 | AUPR: 0.8937
EarlyStopping counter: 1 out of 10
[Epoch 11/100] Train Loss: 0.4441 Valid Loss: 0.4946 | Acc: 0.8061 | Prec: 0.7677 | Recall: 0.8714 | F1: 0.8163 | MCC: 0.6183 | AUROC: 0.8904 | AUPR: 0.8883
EarlyStopping counter: 2 out of 10
[Epoch 12/100] Train Loss: 0.4358 Valid Loss: 0.4917 | Acc: 0.8032 | Prec: 0.7960 | Recall: 0.8093 | F1: 0.8026 | MCC: 0.6066 | AUROC: 0.8845 | AUPR: 0.8861
EarlyStopping counter: 3 out of 10
[Epoch 13/100] Train Loss: 0.4345 Valid Loss: 0.4765 | Acc: 0.8303 | Prec: 0.8455 | Recall: 0.8035 | F1: 0.8240 | MCC: 0.6612 | AUROC: 0.8992 | AUPR: 0.8935
[Epoch 14/100] Train Loss: 0.4210 Valid Loss: 0.5047 | Acc: 0.8040 | Prec: 0.7710 | Recall: 0.8583 | F1: 0.8123 | MCC: 0.6122 | AUROC: 0.8930 | AUPR: 0.8831
EarlyStopping counter: 1 out of 10
[Epoch 15/100] Train Loss: 0.4215 Valid Loss: 0.4711 | Acc: 0.8242 | Prec: 0.8205 | Recall: 0.8247 | F1: 0.8226 | MCC: 0.6484 | AUROC: 0.9015 | AUPR: 0.8998
[Epoch 16/100] Train Loss: 0.4079 Valid Loss: 0.4652 | Acc: 0.8314 | Prec: 0.8396 | Recall: 0.8145 | F1: 0.8268 | MCC: 0.6629 | AUROC: 0.9029 | AUPR: 0.9044
[Epoch 17/100] Train Loss: 0.4041 Valid Loss: 0.4871 | Acc: 0.8134 | Prec: 0.8034 | Recall: 0.8240 | F1: 0.8136 | MCC: 0.6270 | AUROC: 0.8935 | AUPR: 0.8824
EarlyStopping counter: 1 out of 10
[Epoch 18/100] Train Loss: 0.4021 Valid Loss: 0.4623 | Acc: 0.8296 | Prec: 0.8300 | Recall: 0.8240 | F1: 0.8270 | MCC: 0.6591 | AUROC: 0.9064 | AUPR: 0.9040
[Epoch 19/100] Train Loss: 0.3936 Valid Loss: 0.4745 | Acc: 0.8213 | Prec: 0.8321 | Recall: 0.7999 | F1: 0.8156 | MCC: 0.6429 | AUROC: 0.9010 | AUPR: 0.8960
EarlyStopping counter: 1 out of 10
[Epoch 20/100] Train Loss: 0.3896 Valid Loss: 0.4691 | Acc: 0.8329 | Prec: 0.8226 | Recall: 0.8437 | F1: 0.8330 | MCC: 0.6660 | AUROC: 0.9053 | AUPR: 0.8982
EarlyStopping counter: 2 out of 10
[Epoch 21/100] Train Loss: 0.3883 Valid Loss: 0.4848 | Acc: 0.8242 | Prec: 0.7984 | Recall: 0.8619 | F1: 0.8289 | MCC: 0.6507 | AUROC: 0.9020 | AUPR: 0.8916
EarlyStopping counter: 3 out of 10
[Epoch 22/100] Train Loss: 0.3806 Valid Loss: 0.4892 | Acc: 0.8307 | Prec: 0.8328 | Recall: 0.8225 | F1: 0.8276 | MCC: 0.6613 | AUROC: 0.9004 | AUPR: 0.8934
EarlyStopping counter: 4 out of 10
[Epoch 23/100] Train Loss: 0.3814 Valid Loss: 0.4993 | Acc: 0.8199 | Prec: 0.8103 | Recall: 0.8298 | F1: 0.8199 | MCC: 0.6399 | AUROC: 0.8919 | AUPR: 0.8849
EarlyStopping counter: 5 out of 10
[Epoch 24/100] Train Loss: 0.3788 Valid Loss: 0.4912 | Acc: 0.8365 | Prec: 0.8388 | Recall: 0.8283 | F1: 0.8335 | MCC: 0.6729 | AUROC: 0.9033 | AUPR: 0.8957
EarlyStopping counter: 6 out of 10
[Epoch 25/100] Train Loss: 0.3451 Valid Loss: 0.4786 | Acc: 0.8451 | Prec: 0.8476 | Recall: 0.8371 | F1: 0.8423 | MCC: 0.6902 | AUROC: 0.9094 | AUPR: 0.8986
[Epoch 26/100] Train Loss: 0.3292 Valid Loss: 0.4742 | Acc: 0.8390 | Prec: 0.8327 | Recall: 0.8437 | F1: 0.8382 | MCC: 0.6780 | AUROC: 0.9099 | AUPR: 0.9018
[Epoch 27/100] Train Loss: 0.3264 Valid Loss: 0.5019 | Acc: 0.8397 | Prec: 0.8364 | Recall: 0.8400 | F1: 0.8382 | MCC: 0.6794 | AUROC: 0.9090 | AUPR: 0.8980
EarlyStopping counter: 1 out of 10
[Epoch 28/100] Train Loss: 0.3192 Valid Loss: 0.4791 | Acc: 0.8440 | Prec: 0.8407 | Recall: 0.8444 | F1: 0.8426 | MCC: 0.6881 | AUROC: 0.9085 | AUPR: 0.8915
EarlyStopping counter: 2 out of 10
[Epoch 29/100] Train Loss: 0.3156 Valid Loss: 0.5091 | Acc: 0.8448 | Prec: 0.8480 | Recall: 0.8356 | F1: 0.8418 | MCC: 0.6895 | AUROC: 0.9075 | AUPR: 0.8980
EarlyStopping counter: 3 out of 10
[Epoch 30/100] Train Loss: 0.3083 Valid Loss: 0.4846 | Acc: 0.8404 | Prec: 0.8332 | Recall: 0.8466 | F1: 0.8399 | MCC: 0.6810 | AUROC: 0.9082 | AUPR: 0.8976
EarlyStopping counter: 4 out of 10
[Epoch 31/100] Train Loss: 0.3021 Valid Loss: 0.5002 | Acc: 0.8455 | Prec: 0.8467 | Recall: 0.8393 | F1: 0.8430 | MCC: 0.6909 | AUROC: 0.9083 | AUPR: 0.8930
EarlyStopping counter: 5 out of 10
[Epoch 32/100] Train Loss: 0.3023 Valid Loss: 0.5335 | Acc: 0.8426 | Prec: 0.8359 | Recall: 0.8481 | F1: 0.8419 | MCC: 0.6853 | AUROC: 0.9071 | AUPR: 0.8869
EarlyStopping counter: 6 out of 10
[Epoch 33/100] Train Loss: 0.3004 Valid Loss: 0.4932 | Acc: 0.8357 | Prec: 0.8360 | Recall: 0.8305 | F1: 0.8333 | MCC: 0.6714 | AUROC: 0.9101 | AUPR: 0.9013
[Epoch 34/100] Train Loss: 0.2991 Valid Loss: 0.4941 | Acc: 0.8415 | Prec: 0.8331 | Recall: 0.8495 | F1: 0.8412 | MCC: 0.6832 | AUROC: 0.9093 | AUPR: 0.8970
EarlyStopping counter: 1 out of 10
[Epoch 35/100] Train Loss: 0.2986 Valid Loss: 0.4947 | Acc: 0.8426 | Prec: 0.8378 | Recall: 0.8451 | F1: 0.8415 | MCC: 0.6852 | AUROC: 0.9095 | AUPR: 0.8995
EarlyStopping counter: 2 out of 10
[Epoch 36/100] Train Loss: 0.2971 Valid Loss: 0.5390 | Acc: 0.8412 | Prec: 0.8330 | Recall: 0.8488 | F1: 0.8408 | MCC: 0.6825 | AUROC: 0.9064 | AUPR: 0.8917
EarlyStopping counter: 3 out of 10
[Epoch 37/100] Train Loss: 0.2971 Valid Loss: 0.5274 | Acc: 0.8458 | Prec: 0.8473 | Recall: 0.8393 | F1: 0.8433 | MCC: 0.6917 | AUROC: 0.9091 | AUPR: 0.8945
EarlyStopping counter: 4 out of 10
[Epoch 38/100] Train Loss: 0.2975 Valid Loss: 0.4935 | Acc: 0.8440 | Prec: 0.8358 | Recall: 0.8517 | F1: 0.8437 | MCC: 0.6882 | AUROC: 0.9110 | AUPR: 0.8997
[Epoch 39/100] Train Loss: 0.2952 Valid Loss: 0.4939 | Acc: 0.8444 | Prec: 0.8374 | Recall: 0.8503 | F1: 0.8438 | MCC: 0.6889 | AUROC: 0.9083 | AUPR: 0.8971
EarlyStopping counter: 1 out of 10
[Epoch 40/100] Train Loss: 0.2973 Valid Loss: 0.4974 | Acc: 0.8437 | Prec: 0.8519 | Recall: 0.8276 | F1: 0.8396 | MCC: 0.6875 | AUROC: 0.9059 | AUPR: 0.8867
EarlyStopping counter: 2 out of 10
[Epoch 41/100] Train Loss: 0.2973 Valid Loss: 0.5165 | Acc: 0.8430 | Prec: 0.8369 | Recall: 0.8473 | F1: 0.8421 | MCC: 0.6860 | AUROC: 0.9086 | AUPR: 0.8936
EarlyStopping counter: 3 out of 10
[Epoch 42/100] Train Loss: 0.2958 Valid Loss: 0.4910 | Acc: 0.8444 | Prec: 0.8443 | Recall: 0.8400 | F1: 0.8422 | MCC: 0.6888 | AUROC: 0.9090 | AUPR: 0.8945
EarlyStopping counter: 4 out of 10
[Epoch 43/100] Train Loss: 0.2969 Valid Loss: 0.4880 | Acc: 0.8437 | Prec: 0.8300 | Recall: 0.8598 | F1: 0.8446 | MCC: 0.6879 | AUROC: 0.9073 | AUPR: 0.8974
EarlyStopping counter: 5 out of 10
[Epoch 44/100] Train Loss: 0.2935 Valid Loss: 0.5289 | Acc: 0.8448 | Prec: 0.8390 | Recall: 0.8488 | F1: 0.8439 | MCC: 0.6896 | AUROC: 0.9096 | AUPR: 0.8959
EarlyStopping counter: 6 out of 10
[Epoch 45/100] Train Loss: 0.2947 Valid Loss: 0.4823 | Acc: 0.8422 | Prec: 0.8300 | Recall: 0.8561 | F1: 0.8429 | MCC: 0.6849 | AUROC: 0.9093 | AUPR: 0.8992
EarlyStopping counter: 7 out of 10
[Epoch 46/100] Train Loss: 0.2976 Valid Loss: 0.4949 | Acc: 0.8455 | Prec: 0.8392 | Recall: 0.8503 | F1: 0.8447 | MCC: 0.6910 | AUROC: 0.9090 | AUPR: 0.9001
EarlyStopping counter: 8 out of 10
[Epoch 47/100] Train Loss: 0.2965 Valid Loss: 0.5402 | Acc: 0.8433 | Prec: 0.8430 | Recall: 0.8393 | F1: 0.8411 | MCC: 0.6866 | AUROC: 0.9088 | AUPR: 0.8997
EarlyStopping counter: 9 out of 10
[Epoch 48/100] Train Loss: 0.2955 Valid Loss: 0.5278 | Acc: 0.8469 | Prec: 0.8382 | Recall: 0.8554 | F1: 0.8467 | MCC: 0.6940 | AUROC: 0.9055 | AUPR: 0.8901
EarlyStopping counter: 10 out of 10
Early stopping at epoch 48
Best model at epoch 38 with Score = 0.9110
Seed 3407 Test Results:
[Test] Loss: 0.4783 | Acc: 0.8423 | Prec: 0.8322 | Recall: 0.8602 | F1: 0.8460 | MCC: 0.6848 | AUROC: 0.9116 | AUPR: 0.9011

============================================================
Training Seed 5678
============================================================
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_5678/random_train.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 19398 valid pairs (time: 216.72s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_5678/random_val.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 2773 valid pairs (time: 30.86s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_5678/random_test.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 5540 valid pairs (time: 61.37s)
[Epoch 1/100] Train Loss: 0.6108 Valid Loss: 0.5567 | Acc: 0.7454 | Prec: 0.7985 | Recall: 0.6406 | F1: 0.7109 | MCC: 0.4978 | AUROC: 0.8217 | AUPR: 0.8313
[Epoch 2/100] Train Loss: 0.5489 Valid Loss: 0.5494 | Acc: 0.7541 | Prec: 0.7888 | Recall: 0.6782 | F1: 0.7294 | MCC: 0.5112 | AUROC: 0.8377 | AUPR: 0.8365
[Epoch 3/100] Train Loss: 0.5291 Valid Loss: 0.5304 | Acc: 0.7703 | Prec: 0.8037 | Recall: 0.7011 | F1: 0.7489 | MCC: 0.5433 | AUROC: 0.8559 | AUPR: 0.8522
[Epoch 4/100] Train Loss: 0.5117 Valid Loss: 0.5870 | Acc: 0.7840 | Prec: 0.7544 | Recall: 0.8273 | F1: 0.7892 | MCC: 0.5712 | AUROC: 0.8731 | AUPR: 0.8500
[Epoch 5/100] Train Loss: 0.4987 Valid Loss: 0.5105 | Acc: 0.7934 | Prec: 0.7994 | Recall: 0.7705 | F1: 0.7847 | MCC: 0.5866 | AUROC: 0.8754 | AUPR: 0.8684
[Epoch 6/100] Train Loss: 0.4875 Valid Loss: 0.4928 | Acc: 0.8017 | Prec: 0.8357 | Recall: 0.7395 | F1: 0.7847 | MCC: 0.6060 | AUROC: 0.8828 | AUPR: 0.8872
[Epoch 7/100] Train Loss: 0.4774 Valid Loss: 0.5062 | Acc: 0.7973 | Prec: 0.8071 | Recall: 0.7690 | F1: 0.7876 | MCC: 0.5947 | AUROC: 0.8785 | AUPR: 0.8658
EarlyStopping counter: 1 out of 10
[Epoch 8/100] Train Loss: 0.4780 Valid Loss: 0.4932 | Acc: 0.8056 | Prec: 0.8009 | Recall: 0.8015 | F1: 0.8012 | MCC: 0.6111 | AUROC: 0.8837 | AUPR: 0.8803
[Epoch 9/100] Train Loss: 0.4678 Valid Loss: 0.4929 | Acc: 0.8164 | Prec: 0.7933 | Recall: 0.8443 | F1: 0.8180 | MCC: 0.6345 | AUROC: 0.8930 | AUPR: 0.8870
[Epoch 10/100] Train Loss: 0.4688 Valid Loss: 0.4964 | Acc: 0.8024 | Prec: 0.7739 | Recall: 0.8413 | F1: 0.8062 | MCC: 0.6075 | AUROC: 0.8895 | AUPR: 0.8797
EarlyStopping counter: 1 out of 10
[Epoch 11/100] Train Loss: 0.4568 Valid Loss: 0.4868 | Acc: 0.8139 | Prec: 0.7875 | Recall: 0.8480 | F1: 0.8166 | MCC: 0.6301 | AUROC: 0.8952 | AUPR: 0.8870
[Epoch 12/100] Train Loss: 0.4495 Valid Loss: 0.5501 | Acc: 0.8193 | Prec: 0.8220 | Recall: 0.8044 | F1: 0.8131 | MCC: 0.6384 | AUROC: 0.9012 | AUPR: 0.9019
[Epoch 13/100] Train Loss: 0.4400 Valid Loss: 0.4748 | Acc: 0.8182 | Prec: 0.8301 | Recall: 0.7897 | F1: 0.8094 | MCC: 0.6366 | AUROC: 0.8950 | AUPR: 0.8923
EarlyStopping counter: 1 out of 10
[Epoch 14/100] Train Loss: 0.4513 Valid Loss: 0.4723 | Acc: 0.8276 | Prec: 0.8360 | Recall: 0.8052 | F1: 0.8203 | MCC: 0.6552 | AUROC: 0.9006 | AUPR: 0.8893
EarlyStopping counter: 2 out of 10
[Epoch 15/100] Train Loss: 0.4284 Valid Loss: 0.5328 | Acc: 0.8298 | Prec: 0.8225 | Recall: 0.8310 | F1: 0.8267 | MCC: 0.6595 | AUROC: 0.8988 | AUPR: 0.8842
EarlyStopping counter: 3 out of 10
[Epoch 16/100] Train Loss: 0.4235 Valid Loss: 0.4898 | Acc: 0.8024 | Prec: 0.7888 | Recall: 0.8133 | F1: 0.8009 | MCC: 0.6051 | AUROC: 0.8874 | AUPR: 0.8836
EarlyStopping counter: 4 out of 10
[Epoch 17/100] Train Loss: 0.4197 Valid Loss: 0.5101 | Acc: 0.8240 | Prec: 0.8125 | Recall: 0.8317 | F1: 0.8220 | MCC: 0.6482 | AUROC: 0.9031 | AUPR: 0.9014
[Epoch 18/100] Train Loss: 0.4171 Valid Loss: 0.6774 | Acc: 0.8327 | Prec: 0.8337 | Recall: 0.8214 | F1: 0.8275 | MCC: 0.6651 | AUROC: 0.9060 | AUPR: 0.8992
[Epoch 19/100] Train Loss: 0.4139 Valid Loss: 0.6999 | Acc: 0.8399 | Prec: 0.8412 | Recall: 0.8288 | F1: 0.8349 | MCC: 0.6796 | AUROC: 0.9088 | AUPR: 0.9087
[Epoch 20/100] Train Loss: 0.4047 Valid Loss: 0.4720 | Acc: 0.8410 | Prec: 0.8278 | Recall: 0.8517 | F1: 0.8396 | MCC: 0.6822 | AUROC: 0.9114 | AUPR: 0.9102
[Epoch 21/100] Train Loss: 0.3979 Valid Loss: 0.6362 | Acc: 0.8323 | Prec: 0.8316 | Recall: 0.8236 | F1: 0.8276 | MCC: 0.6644 | AUROC: 0.9061 | AUPR: 0.9024
EarlyStopping counter: 1 out of 10
[Epoch 22/100] Train Loss: 0.3901 Valid Loss: 0.5946 | Acc: 0.7901 | Prec: 0.7286 | Recall: 0.9092 | F1: 0.8089 | MCC: 0.6000 | AUROC: 0.8879 | AUPR: 0.8791
EarlyStopping counter: 2 out of 10
[Epoch 23/100] Train Loss: 0.4164 Valid Loss: 0.6072 | Acc: 0.7357 | Prec: 0.6633 | Recall: 0.9321 | F1: 0.7751 | MCC: 0.5173 | AUROC: 0.8814 | AUPR: 0.8829
EarlyStopping counter: 3 out of 10
[Epoch 24/100] Train Loss: 0.3966 Valid Loss: 0.5994 | Acc: 0.8435 | Prec: 0.8161 | Recall: 0.8775 | F1: 0.8457 | MCC: 0.6892 | AUROC: 0.9146 | AUPR: 0.9105
[Epoch 25/100] Train Loss: 0.3826 Valid Loss: 0.4860 | Acc: 0.8348 | Prec: 0.8320 | Recall: 0.8295 | F1: 0.8307 | MCC: 0.6695 | AUROC: 0.9101 | AUPR: 0.9034
EarlyStopping counter: 1 out of 10
[Epoch 26/100] Train Loss: 0.3697 Valid Loss: 0.6080 | Acc: 0.8449 | Prec: 0.8320 | Recall: 0.8554 | F1: 0.8435 | MCC: 0.6902 | AUROC: 0.9114 | AUPR: 0.9046
EarlyStopping counter: 2 out of 10
[Epoch 27/100] Train Loss: 0.3351 Valid Loss: 0.4789 | Acc: 0.8457 | Prec: 0.8160 | Recall: 0.8834 | F1: 0.8483 | MCC: 0.6940 | AUROC: 0.9094 | AUPR: 0.8931
EarlyStopping counter: 3 out of 10
[Epoch 28/100] Train Loss: 0.3232 Valid Loss: 0.5073 | Acc: 0.8439 | Prec: 0.8145 | Recall: 0.8812 | F1: 0.8465 | MCC: 0.6903 | AUROC: 0.9153 | AUPR: 0.9061
[Epoch 29/100] Train Loss: 0.3149 Valid Loss: 0.5869 | Acc: 0.8460 | Prec: 0.8286 | Recall: 0.8635 | F1: 0.8457 | MCC: 0.6927 | AUROC: 0.9156 | AUPR: 0.9080
[Epoch 30/100] Train Loss: 0.3099 Valid Loss: 0.4981 | Acc: 0.8453 | Prec: 0.8341 | Recall: 0.8531 | F1: 0.8435 | MCC: 0.6908 | AUROC: 0.9148 | AUPR: 0.9072
EarlyStopping counter: 1 out of 10
[Epoch 31/100] Train Loss: 0.3101 Valid Loss: 0.4750 | Acc: 0.8453 | Prec: 0.8279 | Recall: 0.8627 | F1: 0.8450 | MCC: 0.6913 | AUROC: 0.9133 | AUPR: 0.9029
EarlyStopping counter: 2 out of 10
[Epoch 32/100] Train Loss: 0.3030 Valid Loss: 0.4966 | Acc: 0.8475 | Prec: 0.8382 | Recall: 0.8524 | F1: 0.8452 | MCC: 0.6950 | AUROC: 0.9119 | AUPR: 0.8960
EarlyStopping counter: 3 out of 10
[Epoch 33/100] Train Loss: 0.2913 Valid Loss: 0.6737 | Acc: 0.8435 | Prec: 0.8245 | Recall: 0.8635 | F1: 0.8435 | MCC: 0.6879 | AUROC: 0.9118 | AUPR: 0.9017
EarlyStopping counter: 4 out of 10
[Epoch 34/100] Train Loss: 0.2945 Valid Loss: 0.5560 | Acc: 0.8485 | Prec: 0.8405 | Recall: 0.8517 | F1: 0.8460 | MCC: 0.6971 | AUROC: 0.9147 | AUPR: 0.9019
EarlyStopping counter: 5 out of 10
[Epoch 35/100] Train Loss: 0.2945 Valid Loss: 0.5011 | Acc: 0.8475 | Prec: 0.8310 | Recall: 0.8635 | F1: 0.8469 | MCC: 0.6955 | AUROC: 0.9117 | AUPR: 0.8967
EarlyStopping counter: 6 out of 10
[Epoch 36/100] Train Loss: 0.2942 Valid Loss: 0.4809 | Acc: 0.8457 | Prec: 0.8347 | Recall: 0.8531 | F1: 0.8438 | MCC: 0.6915 | AUROC: 0.9099 | AUPR: 0.8954
EarlyStopping counter: 7 out of 10
[Epoch 37/100] Train Loss: 0.2910 Valid Loss: 0.6833 | Acc: 0.8428 | Prec: 0.8275 | Recall: 0.8568 | F1: 0.8419 | MCC: 0.6860 | AUROC: 0.9071 | AUPR: 0.8884
EarlyStopping counter: 8 out of 10
[Epoch 38/100] Train Loss: 0.2913 Valid Loss: 0.4988 | Acc: 0.8478 | Prec: 0.8330 | Recall: 0.8613 | F1: 0.8469 | MCC: 0.6961 | AUROC: 0.9123 | AUPR: 0.9052
EarlyStopping counter: 9 out of 10
[Epoch 39/100] Train Loss: 0.2919 Valid Loss: 1.1174 | Acc: 0.8453 | Prec: 0.8270 | Recall: 0.8642 | F1: 0.8452 | MCC: 0.6914 | AUROC: 0.9107 | AUPR: 0.8957
EarlyStopping counter: 10 out of 10
Early stopping at epoch 39
Best model at epoch 29 with Score = 0.9156
Seed 5678 Test Results:
[Test] Loss: 0.7155 | Acc: 0.8556 | Prec: 0.8475 | Recall: 0.8711 | F1: 0.8591 | MCC: 0.7114 | AUROC: 0.9170 | AUPR: 0.9062

============================================================
Training Seed 8888
============================================================
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_8888/random_train.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 19400 valid pairs (time: 216.10s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_8888/random_val.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 2770 valid pairs (time: 31.10s)
Loading data /home/qfchen/ProteinDrugInter/datasets/SNAP/random_split_results/seed_8888/random_test.csv......
Columns in the dataset: ['DRUG_ID', 'UNIPROT_ID', 'Label', 'DRUG_NAME', 'SMILES', 'GENE_NAME', 'SEQUENCE']
Loaded 5541 valid pairs (time: 60.59s)
[Epoch 1/100] Train Loss: 0.5905 Valid Loss: 0.5444 | Acc: 0.7513 | Prec: 0.7272 | Recall: 0.8110 | F1: 0.7668 | MCC: 0.5054 | AUROC: 0.8409 | AUPR: 0.8589
[Epoch 2/100] Train Loss: 0.5323 Valid Loss: 0.5294 | Acc: 0.7726 | Prec: 0.8446 | Recall: 0.6729 | F1: 0.7490 | MCC: 0.5577 | AUROC: 0.8546 | AUPR: 0.8656
[Epoch 3/100] Train Loss: 0.5113 Valid Loss: 0.5032 | Acc: 0.7928 | Prec: 0.7872 | Recall: 0.8074 | F1: 0.7972 | MCC: 0.5856 | AUROC: 0.8760 | AUPR: 0.8901
[Epoch 4/100] Train Loss: 0.4928 Valid Loss: 0.4942 | Acc: 0.7993 | Prec: 0.7984 | Recall: 0.8053 | F1: 0.8019 | MCC: 0.5985 | AUROC: 0.8847 | AUPR: 0.8905
[Epoch 5/100] Train Loss: 0.4790 Valid Loss: 0.4834 | Acc: 0.8177 | Prec: 0.8328 | Recall: 0.7989 | F1: 0.8155 | MCC: 0.6360 | AUROC: 0.8909 | AUPR: 0.8951
[Epoch 6/100] Train Loss: 0.4701 Valid Loss: 0.4958 | Acc: 0.8061 | Prec: 0.8626 | Recall: 0.7323 | F1: 0.7921 | MCC: 0.6200 | AUROC: 0.8865 | AUPR: 0.9005
EarlyStopping counter: 1 out of 10
[Epoch 7/100] Train Loss: 0.4571 Valid Loss: 0.4722 | Acc: 0.8181 | Prec: 0.8395 | Recall: 0.7903 | F1: 0.8142 | MCC: 0.6374 | AUROC: 0.8962 | AUPR: 0.9045
[Epoch 8/100] Train Loss: 0.4489 Valid Loss: 0.4739 | Acc: 0.8159 | Prec: 0.8125 | Recall: 0.8253 | F1: 0.8189 | MCC: 0.6318 | AUROC: 0.8959 | AUPR: 0.9016
EarlyStopping counter: 1 out of 10
[Epoch 9/100] Train Loss: 0.4480 Valid Loss: 0.4774 | Acc: 0.8256 | Prec: 0.8187 | Recall: 0.8404 | F1: 0.8294 | MCC: 0.6514 | AUROC: 0.8953 | AUPR: 0.9026
EarlyStopping counter: 2 out of 10
[Epoch 10/100] Train Loss: 0.4347 Valid Loss: 0.4583 | Acc: 0.8278 | Prec: 0.8433 | Recall: 0.8089 | F1: 0.8257 | MCC: 0.6562 | AUROC: 0.9093 | AUPR: 0.9107
[Epoch 11/100] Train Loss: 0.4275 Valid Loss: 0.4577 | Acc: 0.8350 | Prec: 0.8550 | Recall: 0.8103 | F1: 0.8320 | MCC: 0.6711 | AUROC: 0.9070 | AUPR: 0.9110
EarlyStopping counter: 1 out of 10
[Epoch 12/100] Train Loss: 0.4350 Valid Loss: 0.4846 | Acc: 0.8181 | Prec: 0.8219 | Recall: 0.8160 | F1: 0.8190 | MCC: 0.6361 | AUROC: 0.8981 | AUPR: 0.8901
EarlyStopping counter: 2 out of 10
[Epoch 13/100] Train Loss: 0.4318 Valid Loss: 0.4923 | Acc: 0.8390 | Prec: 0.8509 | Recall: 0.8253 | F1: 0.8379 | MCC: 0.6784 | AUROC: 0.9046 | AUPR: 0.8890
EarlyStopping counter: 3 out of 10
[Epoch 14/100] Train Loss: 0.4209 Valid Loss: 0.4669 | Acc: 0.8242 | Prec: 0.7909 | Recall: 0.8855 | F1: 0.8355 | MCC: 0.6528 | AUROC: 0.9111 | AUPR: 0.9146
[Epoch 15/100] Train Loss: 0.4140 Valid Loss: 0.4651 | Acc: 0.8300 | Prec: 0.8336 | Recall: 0.8282 | F1: 0.8309 | MCC: 0.6599 | AUROC: 0.9073 | AUPR: 0.9149
EarlyStopping counter: 1 out of 10
[Epoch 16/100] Train Loss: 0.4106 Valid Loss: 0.4592 | Acc: 0.8365 | Prec: 0.8401 | Recall: 0.8346 | F1: 0.8373 | MCC: 0.6729 | AUROC: 0.9064 | AUPR: 0.9016
EarlyStopping counter: 2 out of 10
[Epoch 17/100] Train Loss: 0.4055 Valid Loss: 0.4586 | Acc: 0.8325 | Prec: 0.8255 | Recall: 0.8468 | F1: 0.8360 | MCC: 0.6651 | AUROC: 0.9100 | AUPR: 0.9131
EarlyStopping counter: 3 out of 10
[Epoch 18/100] Train Loss: 0.3690 Valid Loss: 0.4564 | Acc: 0.8368 | Prec: 0.8353 | Recall: 0.8425 | F1: 0.8389 | MCC: 0.6736 | AUROC: 0.9131 | AUPR: 0.9173
[Epoch 19/100] Train Loss: 0.3582 Valid Loss: 0.4577 | Acc: 0.8397 | Prec: 0.8353 | Recall: 0.8497 | F1: 0.8424 | MCC: 0.6795 | AUROC: 0.9123 | AUPR: 0.9097
EarlyStopping counter: 1 out of 10
[Epoch 20/100] Train Loss: 0.3463 Valid Loss: 0.4602 | Acc: 0.8419 | Prec: 0.8554 | Recall: 0.8261 | F1: 0.8405 | MCC: 0.6842 | AUROC: 0.9147 | AUPR: 0.9158
[Epoch 21/100] Train Loss: 0.3400 Valid Loss: 0.4542 | Acc: 0.8469 | Prec: 0.8458 | Recall: 0.8518 | F1: 0.8488 | MCC: 0.6938 | AUROC: 0.9169 | AUPR: 0.9167
[Epoch 22/100] Train Loss: 0.3360 Valid Loss: 0.4597 | Acc: 0.8412 | Prec: 0.8521 | Recall: 0.8289 | F1: 0.8403 | MCC: 0.6826 | AUROC: 0.9138 | AUPR: 0.9104
EarlyStopping counter: 1 out of 10
[Epoch 23/100] Train Loss: 0.3318 Valid Loss: 0.4565 | Acc: 0.8477 | Prec: 0.8571 | Recall: 0.8375 | F1: 0.8472 | MCC: 0.6955 | AUROC: 0.9159 | AUPR: 0.9159
EarlyStopping counter: 2 out of 10
[Epoch 24/100] Train Loss: 0.3263 Valid Loss: 0.4600 | Acc: 0.8502 | Prec: 0.8594 | Recall: 0.8404 | F1: 0.8498 | MCC: 0.7006 | AUROC: 0.9166 | AUPR: 0.9160
EarlyStopping counter: 3 out of 10
[Epoch 25/100] Train Loss: 0.3214 Valid Loss: 0.4645 | Acc: 0.8487 | Prec: 0.8564 | Recall: 0.8411 | F1: 0.8487 | MCC: 0.6976 | AUROC: 0.9158 | AUPR: 0.9109
EarlyStopping counter: 4 out of 10
[Epoch 26/100] Train Loss: 0.3154 Valid Loss: 0.4631 | Acc: 0.8487 | Prec: 0.8488 | Recall: 0.8518 | F1: 0.8503 | MCC: 0.6974 | AUROC: 0.9146 | AUPR: 0.9101
EarlyStopping counter: 5 out of 10
[Epoch 27/100] Train Loss: 0.3141 Valid Loss: 0.4673 | Acc: 0.8419 | Prec: 0.8619 | Recall: 0.8175 | F1: 0.8391 | MCC: 0.6848 | AUROC: 0.9160 | AUPR: 0.9187
EarlyStopping counter: 6 out of 10
[Epoch 28/100] Train Loss: 0.3029 Valid Loss: 0.4623 | Acc: 0.8455 | Prec: 0.8429 | Recall: 0.8525 | F1: 0.8477 | MCC: 0.6910 | AUROC: 0.9170 | AUPR: 0.9155
[Epoch 29/100] Train Loss: 0.3015 Valid Loss: 0.4660 | Acc: 0.8458 | Prec: 0.8479 | Recall: 0.8461 | F1: 0.8470 | MCC: 0.6917 | AUROC: 0.9147 | AUPR: 0.9103
EarlyStopping counter: 1 out of 10
[Epoch 30/100] Train Loss: 0.3002 Valid Loss: 0.4706 | Acc: 0.8473 | Prec: 0.8425 | Recall: 0.8576 | F1: 0.8499 | MCC: 0.6946 | AUROC: 0.9146 | AUPR: 0.9050
EarlyStopping counter: 2 out of 10
[Epoch 31/100] Train Loss: 0.3018 Valid Loss: 0.4737 | Acc: 0.8462 | Prec: 0.8516 | Recall: 0.8418 | F1: 0.8467 | MCC: 0.6925 | AUROC: 0.9140 | AUPR: 0.9073
EarlyStopping counter: 3 out of 10
[Epoch 32/100] Train Loss: 0.3002 Valid Loss: 0.4679 | Acc: 0.8469 | Prec: 0.8395 | Recall: 0.8611 | F1: 0.8502 | MCC: 0.6940 | AUROC: 0.9140 | AUPR: 0.9118
EarlyStopping counter: 4 out of 10
[Epoch 33/100] Train Loss: 0.2986 Valid Loss: 0.4705 | Acc: 0.8422 | Prec: 0.8458 | Recall: 0.8404 | F1: 0.8431 | MCC: 0.6845 | AUROC: 0.9153 | AUPR: 0.9141
EarlyStopping counter: 5 out of 10
[Epoch 34/100] Train Loss: 0.2974 Valid Loss: 0.4715 | Acc: 0.8455 | Prec: 0.8508 | Recall: 0.8411 | F1: 0.8459 | MCC: 0.6910 | AUROC: 0.9137 | AUPR: 0.9071
EarlyStopping counter: 6 out of 10
[Epoch 35/100] Train Loss: 0.2981 Valid Loss: 0.4728 | Acc: 0.8412 | Prec: 0.8425 | Recall: 0.8425 | F1: 0.8425 | MCC: 0.6823 | AUROC: 0.9155 | AUPR: 0.9094
EarlyStopping counter: 7 out of 10
[Epoch 36/100] Train Loss: 0.2961 Valid Loss: 0.4715 | Acc: 0.8487 | Prec: 0.8463 | Recall: 0.8554 | F1: 0.8508 | MCC: 0.6975 | AUROC: 0.9135 | AUPR: 0.9074
EarlyStopping counter: 8 out of 10
[Epoch 37/100] Train Loss: 0.2967 Valid Loss: 0.4686 | Acc: 0.8448 | Prec: 0.8436 | Recall: 0.8497 | F1: 0.8466 | MCC: 0.6895 | AUROC: 0.9153 | AUPR: 0.9149
EarlyStopping counter: 9 out of 10
[Epoch 38/100] Train Loss: 0.2972 Valid Loss: 0.4700 | Acc: 0.8412 | Prec: 0.8465 | Recall: 0.8368 | F1: 0.8416 | MCC: 0.6824 | AUROC: 0.9165 | AUPR: 0.9092
EarlyStopping counter: 10 out of 10
Early stopping at epoch 38
Best model at epoch 28 with Score = 0.9170
Seed 8888 Test Results:
[Test] Loss: 0.4694 | Acc: 0.8471 | Prec: 0.8383 | Recall: 0.8638 | F1: 0.8509 | MCC: 0.6945 | AUROC: 0.9123 | AUPR: 0.9007

=== Final Test Results (with Mean ± Std) ===
             Accuracy    Precision  ...        AUROC         AUPR
Seed                                ...                          
42               0.85        0.835  ...        0.916        0.913
1234            0.841        0.828  ...        0.911        0.911
3407            0.842        0.832  ...        0.912        0.901
5678            0.856        0.847  ...        0.917        0.906
8888            0.847        0.838  ...        0.912        0.901
Mean±Std  0.847±0.006  0.836±0.007  ...  0.914±0.003  0.906±0.006

[6 rows x 7 columns]
